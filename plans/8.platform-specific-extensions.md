# Platform-Specific Extensions for Native Binaries

The canonical approach for VS Code extensions with native binaries is platform-specific extensions. Instead of bundling all platform binaries in one package, you publish separate `.vsix` packages for each platform.

## How it works

1. Build your native binary for each platform (win32-x64, darwin-x64, darwin-arm64, linux-x64, etc.)
2. Package each variant separately:
   ```bash
   vsce package --target darwin-x64
   vsce package --target darwin-arm64
   vsce package --target linux-x64
   vsce package --target win32-x64
   ```
3. Publish all variants:
   ```bash
   vsce publish --target darwin-x64 darwin-arm64 linux-x64 win32-x64
   ```

VS Code automatically downloads the correct variant for the user's platform.

## Supported Platforms

The available target platforms include:
- `win32-x64`, `win32-arm64` (Windows)
- `linux-x64`, `linux-arm64`, `linux-armhf` (Linux)
- `alpine-x64`, `alpine-arm64` (Alpine)
- `darwin-x64`, `darwin-arm64` (macOS)
- `web` (browser support)

## Implementation for this extension

To implement this pattern:

1. Set up CI (GitHub Actions) to build `mscore` for each platform
2. Copy the platform-appropriate binary into the extension's dist folder during packaging
3. Update `getMscorePath()` in `native/lib/client.ts` to resolve the path relative to the extension's install location (using `context.extensionPath` passed from the extension activation)

## Alternative approach

Downloading the binary on first activation is an alternative, but it requires network access and adds complexity.

## References

- [VS Code Bundling Extensions](https://code.visualstudio.com/api/working-with-extensions/bundling-extension)
- [VS Code Publishing Extensions](https://code.visualstudio.com/api/working-with-extensions/publishing-extension)
- [vsce issue on OS-specific binaries](https://github.com/microsoft/vscode-vsce/issues/544)
